#!/usr/bin/env ruby

require 'sql_reporter'

def print_usage
  puts "Usage: sql_tracker master_file.json feature_file.json"
end

def print_success
  puts "[Comparison Successful] Comparison report written to: #{`pwd`.strip + '/' + Reporter::LOG_NAME}"
end

def ensure_params_passed
  return if ARGV.size == 2
  STDERR.puts "[ERROR] Incorrect parameters passed"
  print_usage
  exit(1)
end

ensure_params_passed
begin
  Reporter.new(SqlReporter::Parser.parse).generate_report
  print_success
rescue StandardError => e
  STDERR.puts('[ERROR] Unexpected Error occured')
  puts e.message
  puts e.backtrace
end
